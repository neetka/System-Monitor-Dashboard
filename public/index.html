<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced System Monitor</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
  <style>
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }

    body {
      background: #0f172a;
      color: #e2e8f0;
      overflow-x: hidden;
      transition: all 0.3s ease;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 30px auto;
      padding: 0 24px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      padding: 16px 24px;
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    header h1 {
      font-size: 2.25rem;
      font-weight: 700;
      background: linear-gradient(135deg, #60a5fa, #3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.025em;
    }

    .controls {
      display: flex;
      gap: 16px;
      align-items: center;
    }

    #theme-toggle, #export-btn, #auto-refresh-btn {
      background: rgba(59, 130, 246, 0.1);
      color: #60a5fa;
      border: 1px solid rgba(59, 130, 246, 0.2);
      padding: 10px 20px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
    }

    #theme-toggle:hover, #export-btn:hover, #auto-refresh-btn:hover {
      background: rgba(59, 130, 246, 0.2);
      transform: translateY(-1px);
    }

    .dashboard {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
    }

    .section {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: transform 0.2s;
    }

    .section.time-section {
      text-align: center;
      padding: 32px;
    }

    .section.time-section #current-time {
      font-size: 2.5rem;
      font-weight: 600;
      color: #60a5fa;
      text-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
    }

    .section:hover {
      transform: translateY(-2px);
    }

    .section h2 {
      font-size: 1.5rem;
      margin-bottom: 16px;
      color: #60a5fa;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .chart-container {
      position: relative;
      height: 250px;
      width: 100%;
      margin: 0 auto;
      padding: 16px 0;
    }

    .cpu-stats, .memory-stats {
      margin-top: 16px;
      font-size: 1.25rem;
      color: #93c5fd;
      font-weight: 500;
      text-align: center;
    }

    #search-process {
      width: 100%;
      padding: 12px 16px;
      margin-bottom: 16px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      background: rgba(30, 41, 59, 0.5);
      color: white;
      font-size: 1rem;
      transition: all 0.2s;
    }

    #search-process:focus {
      outline: none;
      border-color: #60a5fa;
      box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.2);
    }

    .process-list {
      max-height: 400px;
      overflow-y: auto;
      padding-right: 8px;
    }

    .process-list::-webkit-scrollbar {
      width: 8px;
    }

    .process-list::-webkit-scrollbar-track {
      background: rgba(30, 41, 59, 0.3);
      border-radius: 4px;
    }

    .process-list::-webkit-scrollbar-thumb {
      background: #60a5fa;
      border-radius: 4px;
    }

    .process-item {
      display: grid;
      grid-template-columns: auto 1fr auto auto;
      gap: 16px;
      align-items: center;
      padding: 16px;
      background: rgba(30, 41, 59, 0.7);
      margin: 8px 0;
      border-radius: 12px;
      transition: all 0.2s;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .process-item:hover {
      background: rgba(30, 41, 59, 0.8);
      transform: translateX(4px);
    }

    .kill-btn {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.2);
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
    }

    .kill-btn:hover {
      background: rgba(239, 68, 68, 0.2);
      transform: translateY(-1px);
    }

    #modal {
      backdrop-filter: blur(8px);
      background: rgba(15, 23, 42, 0.6);
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: rgba(30, 41, 59, 0.95);
      padding: 32px;
      border-radius: 24px;
      width: 450px;
      max-width: 90%;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-content h3 {
      font-size: 2rem;
      color: #60a5fa;
      margin-bottom: 24px;
      font-weight: 600;
    }

    .modal-warning-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      color: #ef4444;
      animation: pulseWarning 2s infinite;
    }

    @keyframes pulseWarning {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .modal-process-info {
      background: rgba(15, 23, 42, 0.5);
      padding: 16px;
      border-radius: 12px;
      margin: 20px 0;
      text-align: left;
    }

    .modal-process-info p {
      margin: 8px 0;
      color: #94a3b8;
      font-size: 0.95rem;
    }

    .modal-process-info strong {
      color: #e2e8f0;
      font-weight: 500;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 24px;
    }

    #confirm-btn {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.2);
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
      min-width: 120px;
    }

    #confirm-btn:hover {
      background: rgba(239, 68, 68, 0.2);
      transform: translateY(-1px);
    }

    #cancel-btn {
      background: rgba(30, 41, 59, 0.5);
      color: #e2e8f0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
      min-width: 120px;
    }

    #cancel-btn:hover {
      background: rgba(30, 41, 59, 0.8);
      transform: translateY(-1px);
    }

    .notification {
      position: fixed;
      top: 24px;
      right: 24px;
      background: rgba(239, 68, 68, 0.9);
      color: white;
      padding: 16px 24px;
      border-radius: 12px;
      display: none;
      z-index: 1000;
      animation: slideIn 0.5s ease, fadeOut 0.5s ease 3s forwards;
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }

    #refresh-interval {
      width: 120px;
      height: 6px;
      -webkit-appearance: none;
      background: rgba(59, 130, 246, 0.1);
      border-radius: 3px;
      outline: none;
    }

    #refresh-interval::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: #60a5fa;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s;
    }

    #refresh-interval::-webkit-slider-thumb:hover {
      transform: scale(1.2);
    }

    @media (max-width: 768px) {
      .container {
        margin: 16px auto;
        padding: 0 16px;
      }

      header {
        flex-direction: column;
        gap: 16px;
        text-align: center;
        padding: 16px;
      }

      header h1 {
        font-size: 1.75rem;
      }

      .controls {
        flex-wrap: wrap;
        justify-content: center;
      }

      .section {
        padding: 16px;
      }

      .metrics-grid {
        grid-template-columns: 1fr;
      }
    }

    .metrics-card {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-top: 16px;
    }

    .metric-value {
      font-size: 2rem;
      font-weight: 600;
      color: #60a5fa;
      text-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
    }


    .metric-label {
      font-size: 0.9rem;
      color: #94a3b8;
    }

    .process-icon {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(96, 165, 250, 0.1);
      border-radius: 6px;
      color: #60a5fa;
    }

    .process-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .process-name {
      font-weight: 500;
      color: #e2e8f0;
    }

    .process-details {
      font-size: 0.85rem;
      color: #94a3b8;
    }

    .process-stats {
      display: flex;
      gap: 16px;
      align-items: center;
    }

    .stat {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 0.9rem;
      color: #94a3b8;
    }

    .stat-icon {
      width: 16px;
      height: 16px;
    }

    .resource-warning {
      color: #fbbf24;
    }

    .resource-critical {
      color: #ef4444;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .chart-legend {
      display: flex;
      gap: 16px;
      align-items: center;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      color: #94a3b8;
    }

    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 2px;
    }

    .system-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .summary-card {
      background: rgba(35, 45, 62, 0.7);
      border-radius: 12px;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .summary-title {
      font-size: 0.9rem;
      color: #94a3b8;
    }

    .summary-value {
      font-size: 1.5rem;
      font-weight: 600;
      color: #60a5fa;
    }

    .trend-indicator {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 0.85rem;
    }

    .trend-up {
      color: #34d399;
    }

    .trend-down {
      color: #ef4444;
    }
  </style>
</head>
<body>
    <div class="container">
      <header>
        <h1>Advanced System Monitor</h1>
        <div class="controls">
          <button id="theme-toggle">Toggle Dark Mode</button>
          <button id="export-btn">Export Data</button>
          <button id="auto-refresh-btn">Auto-Refresh: On</button>
          <input type="range" id="refresh-interval" min="1" max="10" value="2">
        </div>
      </header>
      <div class="dashboard">
        <div class="section time-section">
          <h2>System Overview</h2>
          <p id="current-time" style="color: #60a5fa;">Loading...</p>
          <div class="system-summary">
            <div class="summary-card">
              <span class="summary-title">System Load</span>
              <span class="summary-value" id="system-load">0.00</span>
              <span class="trend-indicator trend-up">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M8 4L12 8L4 8L8 4Z" fill="currentColor"/>
                </svg>
                <span>2.3%</span>
              </span>
            </div>
            <div class="summary-card">
              <span class="summary-title">Active Processes</span>
              <span class="summary-value" id="active-processes">0</span>
            </div>
            <div class="summary-card">
              <span class="summary-title">System Uptime</span>
              <span class="summary-value" id="system-uptime">0:00:00</span>
            </div>
          </div>
        </div>

        <div class="metrics-grid">
          <div class="section">
            <div class="chart-header">
              <h2>CPU Usage</h2>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color" style="background: #60a5fa;"></div>
                  <span>User</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #34d399;"></div>
                  <span>System</span>
                </div>
              </div>
            </div>
            <div class="chart-container">
              <canvas id="cpuChart"></canvas>
            </div>
            <div class="metrics-card">
              <div>
                <div class="metric-value" id="cpu-value">0%</div>
                <div class="metric-label">Current Usage</div>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="chart-header">
              <h2>Memory Usage</h2>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color" style="background: #60a5fa;"></div>
                  <span>Used</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #34d399;"></div>
                  <span>Available</span>
                </div>
              </div>
            </div>
            <div class="chart-container">
              <canvas id="memoryChart"></canvas>
            </div>
            <div class="metrics-card">
              <div>
                <div class="metric-value" id="memory-value">0 GB</div>
                <div class="metric-label">Used Memory</div>
              </div>
              <div>
                <div class="metric-value" id="memory-available">0 GB</div>
                <div class="metric-label">Available</div>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <h2>Top Processes</h2>
          <input type="text" id="search-process" placeholder="Search processes by name, PID, or resource usage...">
          <div class="process-list" id="process-list">
            <!-- Process items will be dynamically added here -->
          </div>
        </div>
      </div>
    </div>
    <div id="modal">
      <div class="modal-content">
        <svg class="modal-warning-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
        </svg>
        <h3>Process Details</h3>
        <div class="modal-process-info">
          <p><strong>PID:</strong> <span id="modal-pid"></span></p>
          <p><strong>CPU History:</strong> <span id="cpu-history"></span></p>
          <p><strong>Memory Trend:</strong> <span id="memory-trend"></span></p>
        </div>
        <div class="modal-actions">
          <button id="cancel-btn">Cancel</button>
          <button id="confirm-btn">Terminate</button>
        </div>
      </div>
    </div>
    <div id="notification" class="notification"></div>
  
    <script>
      let cpuChart, memoryChart;
      let cpuData = Array(30).fill(0);
      let autoRefresh = true;
      let refreshInterval = 2000;
      let refreshIntervalId;
      let currentPid = null;

      function initCharts() {
        // CPU Chart
        cpuChart = new Chart(document.getElementById('cpuChart'), {
          type: 'line',
          data: {
            labels: Array(30).fill(''),
            datasets: [{
              label: 'User CPU',
              data: cpuData,
              borderColor: '#60a5fa',
              backgroundColor: 'rgba(96, 165, 250, 0.1)',
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                min: 0,
                max: 100,
                grid: {
                  color: 'rgba(255, 255, 255, 0.1)'
                },
                ticks: {
                  color: '#94a3b8'
                }
              },
              x: {
                grid: {
                  color: 'rgba(255, 255, 255, 0.1)'
                },
                ticks: {
                  color: '#94a3b8'
                }
              }
            },
            plugins: {
              legend: {
                display: false
              }
            },
            animation: {
              duration: 500
            }
          }
        });

        // Memory Chart
        memoryChart = new Chart(document.getElementById('memoryChart'), {
          type: 'doughnut',
          data: {
            labels: ['Used', 'Available'],
            datasets: [{
              data: [0, 1],
              backgroundColor: ['#60a5fa', '#34d399'],
              borderWidth: 0,
              cutout: '75%'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false
              }
            }
          }
        });
      }

      async function fetchData() {
        try {
          const [statsRes, procRes] = await Promise.all([
            fetch('http://localhost:3000/system-stats'),
            fetch('http://localhost:3000/processes')
          ]);

          if (!statsRes.ok) throw new Error(`HTTP error! status: ${statsRes.status}`);
          if (!procRes.ok) throw new Error(`HTTP error! status: ${procRes.status}`);

          const stats = await statsRes.json();
          const processes = await procRes.json();

          // Update system metrics
          document.getElementById('system-load').textContent = stats.load.toFixed(2);
          document.getElementById('active-processes').textContent = stats.activeProcesses;
          document.getElementById('system-uptime').textContent = formatUptime(stats.uptime);
          document.getElementById('current-time').textContent = new Date().toLocaleTimeString();

          // Update CPU metrics
          document.getElementById('cpu-value').textContent = `${stats.cpu}%`;
          cpuData = [...cpuData.slice(1), parseFloat(stats.cpu)];
          cpuChart.data.datasets[0].data = cpuData;
          cpuChart.update();

          // Update memory metrics with proper values
          const usedMemory = Number(stats.memory.used);
          const availableMemory = Number(stats.memory.available);
          const totalMemory = Number(stats.memory.total);
          
          // Format memory values for display
          document.getElementById('memory-value').textContent = `${usedMemory.toFixed(1)} GB`;
          document.getElementById('memory-available').textContent = `${availableMemory.toFixed(1)} GB`;
          
          // Update memory chart with numeric values
          memoryChart.data.datasets[0].data = [usedMemory, availableMemory];
          memoryChart.update();

          // Add memory percentage indicator if needed
          const memoryPercentage = Number(stats.memory.percentage);
          if (memoryPercentage > 80) {
            showNotification(`High Memory Usage: ${memoryPercentage}%`);
          }

          // Update process list
          updateProcessList(processes);

          // Check for warnings
          if (parseFloat(stats.cpu) > 80) {
            showNotification(`High CPU Usage: ${stats.cpu}%!`);
          }
          if (availableMemory < 2) {
            showNotification(`Low Memory: Only ${availableMemory.toFixed(1)} GB available!`);
          }
        } catch (error) {
          console.error('Fetch error:', error);
          showNotification(`Connection error: ${error.message}`);
        }
      }

      function formatUptime(seconds) {
        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = seconds % 60;
        return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      }

      function updateProcessList(processes) {
        const processList = document.getElementById('process-list');
        processList.innerHTML = processes.map(proc => `
          <div class="process-item" onclick="showModal('${proc.pid}', ${proc.cpu}, ${proc.memory})">
            <div class="process-icon">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M8 2L14 5V11L8 14L2 11V5L8 2Z" stroke="currentColor" stroke-width="1.5"/>
              </svg>
            </div>
            <div class="process-info">
              <span class="process-name">${proc.name}</span>
              <span class="process-details">PID: ${proc.pid}</span>
            </div>
            <div class="process-stats">
              <span class="stat ${proc.cpu > 80 ? 'resource-critical' : proc.cpu > 50 ? 'resource-warning' : ''}">
                <svg class="stat-icon" viewBox="0 0 16 16" fill="none">
                  <path d="M2 14V2M14 14V2M6 14V2M10 14V2" stroke="currentColor" stroke-width="1.5"/>
                </svg>
                ${proc.cpu}%
              </span>
              <span class="stat">
                <svg class="stat-icon" viewBox="0 0 16 16" fill="none">
                  <path d="M2 14H14M8 2V10" stroke="currentColor" stroke-width="1.5"/>
                </svg>
                ${proc.memory} MB
              </span>
            </div>
            <button class="kill-btn" onclick="showKillModal('${proc.pid}', event)">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M4 4L12 12M4 12L12 4" stroke="currentColor" stroke-width="1.5"/>
              </svg>
            </button>
          </div>
        `).join('');
      }

      function showNotification(message) {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.style.display = 'block';
        setTimeout(() => notification.style.display = 'none', 3500);
      }

      function showModal(pid, cpu, memory) {
        currentPid = pid;
        document.getElementById('modal-pid').textContent = `PID: ${pid}`;
        document.getElementById('cpu-history').textContent = `Recent CPU: ${cpu.toFixed(2)}% (simulated)`;
        document.getElementById('memory-trend').textContent = `Recent Mem: ${memory.toFixed(2)} GB (simulated)`;
        document.getElementById('modal').style.display = 'flex';
      }

      // function showKillModal(pid, event) {
      //   event.stopPropagation();
      //   currentPid = pid;
      //   document.getElementById('modal-pid').textContent = `PID: ${pid} - Confirm Kill?`;
      //   document.getElementById('cpu-history').textContent = '';
      //   document.getElementById('memory-trend').textContent = '';
      //   document.getElementById('modal').style.display = 'flex';
      // }

      // ... existing code ...

function showKillModal(pid, event) {
  event.stopPropagation();
  currentPid = pid;
  
  // Find the process data from the process list
  const processItem = event.target.closest('.process-item');
  const cpuValue = processItem.querySelector('.stat:first-child').textContent.trim();
  const memoryValue = processItem.querySelector('.stat:last-child').textContent.trim();
  
  document.getElementById('modal-pid').textContent = `PID: ${pid} - Confirm Kill?`;
  document.getElementById('cpu-history').textContent = `CPU Usage: ${cpuValue}`;
  document.getElementById('memory-trend').textContent = `Memory Usage: ${memoryValue}`;
  document.getElementById('modal').style.display = 'flex';
}

// ... existing code ...

      document.getElementById('cancel-btn').addEventListener('click', () => {
        document.getElementById('modal').style.display = 'none';
        currentPid = null;
      });

      document.getElementById('confirm-btn').addEventListener('click', async () => {
        if (currentPid) {
          try {
            await killProcess(currentPid);
          } catch (error) {
            console.error('Error killing process:', error);
            showNotification('Error terminating process!');
          }
        }
        document.getElementById('modal').style.display = 'none';
        currentPid = null;
      });

      // ... existing code ...

document.getElementById('theme-toggle').addEventListener('click', () => {
  const body = document.body;
  const isDarkMode = body.style.background === 'rgb(15, 23, 42)' || !body.style.background;
  
  if (isDarkMode) {
    // Light mode styles
    body.style.background = '#ffffff';
    body.style.color = '#1a202c';
    
    document.querySelectorAll('.section').forEach(el => {
      el.style.background = '#ffffff';
      el.style.boxShadow = '0 1px 3px rgba(0, 0, 0, 0.1)';
      el.style.border = '1px solid #e2e8f0';
    });

    document.querySelectorAll('.summary-card').forEach(el => {
      el.style.background = '#ffffff';
      el.style.border = '1px solid #e2e8f0';
    });

    document.querySelectorAll('.metric-value').forEach(el => {
      el.style.color = '#2c5282';
      el.style.textShadow = 'none';
    });

    document.querySelectorAll('.metric-label').forEach(el => {
      el.style.color = '#4a5568';
    });

    document.querySelectorAll('.process-item').forEach(el => {
      el.style.background = '#ffffff';
      el.style.border = '1px solid #e2e8f0';
      el.style.boxShadow = '0 1px 2px rgba(0, 0, 0, 0.05)';
    });
    document.querySelectorAll('.process-name').forEach(el => {
      el.style.color = '#1a202c';
    });

    document.querySelectorAll('.process-details').forEach(el => {
      el.style.color = '#64748b';
    });

    document.querySelectorAll('.stat').forEach(el => {
      el.style.color = '#475569';
    });

    document.querySelectorAll('.process-icon').forEach(el => {
      el.style.background = '#f1f5f9';
      el.style.color = '#3b82f6';
    });

    document.getElementById('modal').style.background = 'rgba(255, 255, 255, 0.8)';
    document.querySelector('.modal-content').style.background = '#ffffff';

    document.querySelector('header').style.background = '#ffffff';
    document.getElementById('search-process').style.background = '#ffffff';
    document.getElementById('search-process').style.border = '1px solid #e2e8f0';
    document.getElementById('search-process').style.color = '#1a202c';
  } else {
    // Dark mode styles
    body.style.background = '#0f172a';
    body.style.color = '#e2e8f0';
    
    document.querySelectorAll('.section').forEach(el => {
      el.style.background = 'rgba(30, 41, 59, 0.7)';
      el.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.1)';
      el.style.border = '1px solid rgba(255, 255, 255, 0.1)';
    });

    document.querySelectorAll('.summary-card').forEach(el => {
      el.style.background = 'rgba(30, 41, 59, 0.7)';
      el.style.border = '1px solid rgba(255, 255, 255, 0.1)';
    });

    document.querySelectorAll('.metric-value').forEach(el => {
      el.style.color = '#60a5fa';
      el.style.textShadow = '0 0 20px rgba(96, 165, 250, 0.3)';
    });

    document.querySelectorAll('.metric-label').forEach(el => {
      el.style.color = '#94a3b8';
    });

    document.querySelectorAll('.process-item').forEach(el => {
      el.style.background = 'rgba(30, 41, 59, 0.7)';
      el.style.border = '1px solid rgba(255, 255, 255, 0.1)';
    });
document.querySelectorAll('.process-name').forEach(el => {
      el.style.color = '#e2e8f0';
    });

    document.querySelectorAll('.process-details').forEach(el => {
      el.style.color = '#94a3b8';
    });

    document.querySelectorAll('.stat').forEach(el => {
      el.style.color = '#94a3b8';
    });

    document.querySelectorAll('.process-icon').forEach(el => {
      el.style.background = 'rgba(96, 165, 250, 0.1)';
      el.style.color = '#60a5fa';
    });
    

    document.getElementById('modal').style.background = 'rgba(15, 23, 42, 0.6)';
    document.querySelector('.modal-content').style.background = 'rgba(30, 41, 59, 0.95)';

    document.querySelector('header').style.background = 'rgba(30, 41, 59, 0.7)';
    document.getElementById('search-process').style.background = 'rgba(30, 41, 59, 0.5)';
    document.getElementById('search-process').style.border = '1px solid rgba(255, 255, 255, 0.1)';
    document.getElementById('search-process').style.color = '#ffffff';
  }
});

// ... existing code ...

      document.getElementById('auto-refresh-btn').addEventListener('click', () => {
        autoRefresh = !autoRefresh;
        document.getElementById('auto-refresh-btn').textContent = `Auto-Refresh: ${autoRefresh ? 'On' : 'Off'}`;
        if (autoRefresh) {
          refreshIntervalId = setInterval(fetchData, refreshInterval);
        } else {
          clearInterval(refreshIntervalId);
        }
      });

      document.getElementById('refresh-interval').addEventListener('input', (e) => {
        refreshInterval = e.target.value * 1000;
        if (autoRefresh) {
          clearInterval(refreshIntervalId);
          refreshIntervalId = setInterval(fetchData, refreshInterval);
        }
      });

      document.getElementById('export-btn').addEventListener('click', async () => {
        const statsRes = await fetch('http://localhost:3000/system-stats');
        const procRes = await fetch('http://localhost:3000/processes');
        const stats = await statsRes.json();
        const processes = await procRes.json();
        const dataStr = `data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify({ stats, processes }, null, 2))}`;
        const downloadAnchorNode = document.createElement('a');
        downloadAnchorNode.setAttribute('href', dataStr);
        downloadAnchorNode.setAttribute('download', `system-stats-${new Date().toISOString()}.json`);
        document.body.appendChild(downloadAnchorNode);
        downloadAnchorNode.click();
        document.body.removeChild(downloadAnchorNode);
      });

      document.getElementById('search-process').addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const processItems = document.querySelectorAll('.process-item');
        processItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          item.style.display = text.includes(searchTerm) ? 'flex' : 'none';
        });
      });

      async function killProcess(pid) {
        try {
          const response = await fetch(`http://localhost:3000/kill/${pid}`, {
            method: 'POST'
          });
          
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          
          const result = await response.json();
          showNotification(result.message);
          fetchData(); // Refresh data after killing process
        } catch (error) {
          console.error('Error killing process:', error);
          showNotification(`Error terminating process: ${error.message}`);
        }
      }

      initCharts();
      fetchData();
      refreshIntervalId = setInterval(fetchData, refreshInterval);
    </script>
  </body>
  </html>
  